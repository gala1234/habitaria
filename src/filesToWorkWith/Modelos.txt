import React, { useState, useEffect, useRef } from 'react';
import { Menu, X, ArrowRight, Box, Layers, Zap, Instagram, Linkedin, Mail, Moon, Sun, BookOpen, FileText, Globe, ShoppingBag, Maximize, Ruler, ChevronDown, Check, Package, ShieldCheck, Truck, Clock } from 'lucide-react';

// --- DICCIONARIO DE TRADUCCIONES (Consistente con Landing) ---
const translations = {
  es: {
    nav: { models: "Modelos", phil: "Filosofía", proj: "Proyectos", serv: "Servicios", store: "Tienda", contact: "Contacto", home: "Inicio" },
    modular: {
      pageTitle: "Nuestra Línea Modular",
      pageSubtitle: "Ingeniería de alta precisión diseñada para el transporte global y la habitabilidad inmediata.",
      newCol: "Colección 2024",
      delivery: "Entrega Inmediata",
      finish: "Acabado Seleccionado",
      finishName: "Microcemento Arena (Estándar)",
      finishNote: "*Imagen referencial. Todos los modelos comparten la misma materialidad y calidad de acabados.",
      basePrice: "Precio Base",
      btnBuy: "Reservar Unidad",
      btnInfo: "Ver Planos"
    },
    models: {
      small: { 
        name: "Modelo S (Compact)", tagline: "El módulo esencial.", 
        desc: "La unidad fundamental. Un contenedor marítimo High-Cube optimizado al milímetro. Ideal como oficina premium de jardín, gimnasio privado o suite independiente.",
        specs: ["Módulo Único ISO", "Área: 15 m²", "Dimensiones: 2,5m x 6m", "Instalación en 24h"]
      },
      medium: { 
        name: "Modelo M (Expand)", tagline: "Expansión inteligente.", 
        desc: "Ingeniería desplegable de vanguardia. Al módulo central se le suma un ala lateral plegable de 2.7m, duplicando el espacio vital para una vida cómoda.",
        specs: ["1 Módulo + 1 Ala", "Área: 31.2 m²", "Dimensiones: 5,2m x 6m", "Salón-Comedor Amplio"]
      },
      large: { 
        name: "Modelo L (Grand)", tagline: "Residencia completa.", 
        desc: "Máxima expresión de habitabilidad modular. Despliega alas a ambos lados (2.7m c/u) creando una residencia familiar de casi 50m² lista para entrar a vivir.",
        specs: ["1 Módulo + 2 Alas", "Área: 47.4 m²", "Dimensiones: 7,9m x 6m", "Dormitorio Doble + Salón"]
      }
    },
    tech: {
      title: "Calidad Robusta",
      s1: "Aislamiento Térmico", d1: "Paneles de alta densidad que garantizan confort climático extremo.",
      s2: "Estructura Acero", d2: "Chasis reforzado basado en estándares marítimos internacionales.",
      s3: "Instalación Plug & Play", d3: "Conexiones de agua y electricidad listas para usar al momento."
    },
    footer: {
      talk: "Hablemos", future: "de futuro.", desc: "¿Listo para construir tu refugio?",
      form: { name: "Nombre", interest: "Interés", msg: "Mensaje", btn: "Enviar Mensaje" },
      cols: { brand: "Marca", store: "Tienda", info: "Info", legal: "Legal" }
    }
  },
  en: {
    nav: { models: "Models", phil: "Philosophy", proj: "Projects", serv: "Services", store: "Store", contact: "Contact", home: "Home" },
    modular: {
      pageTitle: "Our Modular Line",
      pageSubtitle: "High-precision engineering designed for global transport and immediate livability.",
      newCol: "2024 Collection",
      delivery: "Immediate Delivery",
      finish: "Selected Finish",
      finishName: "Sand Microcement (Standard)",
      finishNote: "*Reference image. All models share the same high-quality materials and finishes.",
      basePrice: "Base Price",
      btnBuy: "Reserve Now",
      btnInfo: "View Floorplans"
    },
    models: {
      small: { 
        name: "Model S (Compact)", tagline: "The essential module.", 
        desc: "The fundamental unit. A High-Cube shipping container optimized to the millimeter. Ideal as a premium garden office, private gym, or independent suite.",
        specs: ["Single ISO Module", "Area: 15 m²", "Dims: 2.5m x 6m", "24h Installation"]
      },
      medium: { 
        name: "Model M (Expand)", tagline: "Smart expansion.", 
        desc: "Cutting-edge deployable engineering. A 2.7m folding side wing is added to the central module, doubling the living space for a comfortable life.",
        specs: ["1 Module + 1 Wing", "Area: 31.2 m²", "Dims: 5.2m x 6m", "Expanded Lounge"]
      },
      large: { 
        name: "Model L (Grand)", tagline: "Full residence.", 
        desc: "The ultimate expression of modular living. Deploys wings on both sides (2.7m each), creating a family residence of nearly 50m² ready to move in.",
        specs: ["1 Module + 2 Wings", "Area: 47.4 m²", "Dims: 7.9m x 6m", "Double Bed + Lounge"]
      }
    },
    tech: {
      title: "Robust Quality",
      s1: "Thermal Insulation", d1: "High-density panels ensuring extreme climatic comfort.",
      s2: "Steel Structure", d2: "Reinforced chassis based on international maritime standards.",
      s3: "Plug & Play", d3: "Water and electricity connections ready for immediate use."
    },
    footer: {
      talk: "Let's talk", future: "about future.", desc: "Ready to build your sanctuary?",
      form: { name: "Name", interest: "Interest", msg: "Message", btn: "Send Message" },
      cols: { brand: "Brand", store: "Store", info: "Info", legal: "Legal" }
    }
  }
};

// --- COMPONENTES COMPARTIDOS ---

const Navbar = ({ lang, setLang, theme, toggleTheme, isScrolled }) => {
  const [isLangMenuOpen, setIsLangMenuOpen] = useState(false);
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const t = translations[lang];

  return (
    <nav className={`fixed top-0 left-0 w-full z-50 transition-all duration-500 ${isScrolled ? 'bg-white/95 dark:bg-[#050505]/95 backdrop-blur-xl py-4 border-b border-gray-200 dark:border-white/5' : 'bg-transparent py-8'}`}>
      <div className="container mx-auto px-6 flex justify-between items-center">
        {/* Logo */}
        <div className="flex items-center gap-2 cursor-pointer relative z-[60]">
          <div className="w-8 h-8 bg-gradient-to-br from-orange-500 to-purple-600 rounded flex items-center justify-center transform rotate-45 shadow-lg">
            <div className="w-4 h-4 bg-white dark:bg-[#050505]" />
          </div>
          <span className={`text-2xl font-bold tracking-widest uppercase transition-colors ${isMenuOpen || isScrolled || theme === 'light' ? 'text-gray-900 dark:text-white' : 'text-white'}`}>
            Habitaria
          </span>
        </div>

        {/* Desktop Menu */}
        <div className="hidden md:flex items-center gap-6 lg:gap-10">
          <div className={`flex items-center gap-6 text-sm font-semibold tracking-widest uppercase ${isScrolled || theme === 'light' ? 'text-gray-600 dark:text-neutral-400' : 'text-neutral-200'}`}>
            <button className="hover:text-orange-500 transition-colors">{t.nav.home}</button>
            <button className="text-orange-500 font-bold">{t.nav.models}</button>
            <button className="hover:text-orange-500 transition-colors">{t.nav.proj}</button>
          </div>
          
          <div className="flex items-center gap-3">
            {/* Language Selector */}
            <div className="relative">
              <button 
                onClick={(e) => { e.stopPropagation(); setIsLangMenuOpen(!isLangMenuOpen); }}
                className={`flex items-center gap-1 p-2 rounded-lg transition-all group ${isMenuOpen || isScrolled || theme === 'light' ? 'text-gray-900 dark:text-white hover:text-orange-500' : 'text-white hover:text-orange-300'}`}
              >
                <Globe size={18} />
                <span className="text-xs font-bold uppercase">{lang}</span>
                <ChevronDown size={14} className={`transition-transform duration-300 ${isLangMenuOpen ? 'rotate-180' : ''}`}/>
              </button>
              {isLangMenuOpen && (
                <div className="absolute top-full right-0 mt-2 w-32 bg-white dark:bg-[#1a1a1a] rounded-xl shadow-2xl border border-gray-200 dark:border-white/10 overflow-hidden py-1 z-50">
                  {['es', 'en'].map((l) => (
                    <button key={l} onClick={() => { setLang(l); setIsLangMenuOpen(false); }} className={`w-full text-left px-4 py-2 text-xs uppercase font-bold hover:bg-gray-50 dark:hover:bg-white/5 transition-colors ${lang === l ? 'text-orange-500' : 'text-gray-500'}`}>{l}</button>
                  ))}
                </div>
              )}
            </div>

            <button onClick={toggleTheme} className={`p-2 rounded-full transition-colors ${isMenuOpen || isScrolled || theme === 'light' ? 'text-gray-900 dark:text-white hover:bg-gray-100' : 'text-white hover:bg-white/10'}`}>
              {theme === 'dark' ? <Sun size={18} /> : <Moon size={18} />}
            </button>
          </div>
        </div>

        {/* Mobile Toggle */}
        <button className={`md:hidden relative z-[60] ${isMenuOpen || isScrolled || theme === 'light' ? 'text-gray-900 dark:text-white' : 'text-white'}`} onClick={() => setIsMenuOpen(!isMenuOpen)}>
          {isMenuOpen ? <X size={28} /> : <Menu size={28} />}
        </button>
      </div>
    </nav>
  );
};

const Footer = ({ lang }) => {
  const t = translations[lang];
  return (
    <footer className="bg-gray-100 dark:bg-[#020202] border-t border-gray-200 dark:border-white/10 pt-24 pb-8 transition-colors">
      <div className="container mx-auto px-6 mb-20 grid md:grid-cols-2 gap-16">
        <div>
          <h2 className="text-5xl font-bold uppercase mb-4 text-gray-900 dark:text-white">
            {t.footer.talk}<br />
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-purple-600">{t.footer.future}</span>
          </h2>
          <p className="text-gray-600 dark:text-neutral-400 max-w-sm mb-8">{t.footer.desc}</p>
          <div className="flex gap-4">
            <div className="w-10 h-10 rounded-full border border-gray-300 dark:border-white/20 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:text-orange-500 cursor-pointer"><Instagram size={20} /></div>
            <div className="w-10 h-10 rounded-full border border-gray-300 dark:border-white/20 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:text-orange-500 cursor-pointer"><Linkedin size={20} /></div>
          </div>
        </div>
        <form className="bg-white dark:bg-[#0a0a0a] p-8 rounded-2xl border border-gray-200 dark:border-white/5 shadow-xl">
          <div className="grid gap-4">
            <input placeholder={t.footer.form.name} className="bg-gray-50 dark:bg-[#151515] border border-gray-200 dark:border-white/10 p-4 rounded-lg outline-none focus:border-orange-500 text-gray-900 dark:text-white" />
            <button className="bg-gradient-to-r from-orange-500 to-purple-600 text-white font-bold uppercase py-4 rounded-lg shadow-lg hover:translate-x-1 transition-all">
              {t.footer.form.btn}
            </button>
          </div>
        </form>
      </div>
      <div className="container mx-auto px-6 border-t border-gray-200 dark:border-white/10 pt-8 flex justify-between items-center text-[10px] uppercase tracking-widest text-gray-500">
        <p>© 2024 HABITARIA</p>
        <div className="flex items-center gap-2"><Globe size={14} /><span>{lang.toUpperCase()}</span></div>
      </div>
    </footer>
  );
};

// --- COMPONENTE: PÁGINA DE MODELOS ---

const App = () => {
  const [lang, setLang] = useState('es');
  const [theme, setTheme] = useState('dark');
  const [isScrolled, setIsScrolled] = useState(false);
  const [activeModel, setActiveModel] = useState('medium');

  const t = translations[lang];

  useEffect(() => {
    const handleScroll = () => setIsScrolled(window.scrollY > 50);
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const modelsData = {
    small: { id: 'small', ...t.models.small, area: "15 m²", dims: "2.5m x 6m", price: "24.900€", img: "https://images.unsplash.com/photo-1521783593447-5702b9bc7252?q=80&w=1200&auto=format&fit=crop" },
    medium: { id: 'medium', ...t.models.medium, area: "31.2 m²", dims: "5.2m x 6m", price: "42.500€", img: "https://images.unsplash.com/photo-1613553507747-5f8d62ad5904?q=80&w=1200&auto=format&fit=crop" },
    large: { id: 'large', ...t.models.large, area: "47.4 m²", dims: "7.9m x 6m", price: "58.900€", img: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=1200&auto=format&fit=crop" }
  };

  return (
    <div className={theme === 'dark' ? 'dark' : ''}>
      <div className="min-h-screen bg-white dark:bg-[#050505] transition-colors duration-500 font-sans">
        
        <Navbar lang={lang} setLang={setLang} theme={theme} toggleTheme={() => setTheme(theme === 'dark' ? 'light' : 'dark')} isScrolled={isScrolled} />

        <main className="pt-32 pb-24">
          <div className="container mx-auto px-6">
            
            {/* Header de Página */}
            <div className="text-center mb-20 max-w-3xl mx-auto">
              <div className="inline-flex items-center gap-2 px-4 py-2 bg-orange-500/10 rounded-full text-orange-500 font-bold text-xs uppercase tracking-widest mb-6">
                 <Package size={14} /> {t.modular.newCol}
              </div>
              <h1 className="text-5xl md:text-8xl font-black uppercase text-gray-900 dark:text-white mb-6 leading-[0.9]">
                {t.modular.pageTitle}
              </h1>
              <p className="text-lg text-gray-600 dark:text-neutral-400 leading-relaxed">
                {t.modular.pageSubtitle}
              </p>
            </div>

            {/* Selector de Modelos (Tabs) */}
            <div className="flex flex-wrap justify-center gap-3 mb-16">
              {Object.keys(modelsData).map((key) => (
                <button
                  key={key}
                  onClick={() => setActiveModel(key)}
                  className={`px-8 py-3 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${activeModel === key ? 'bg-gray-900 text-white dark:bg-white dark:text-black shadow-2xl scale-105' : 'bg-gray-50 dark:bg-[#111] text-gray-400 border border-gray-200 dark:border-white/5 hover:text-gray-900 dark:hover:text-white'}`}
                >
                  {modelsData[key].name.split(' ')[1]}
                </button>
              ))}
            </div>

            {/* Ficha Técnica Interactiva */}
            <div className="bg-white dark:bg-[#0a0a0a] rounded-[2.5rem] overflow-hidden shadow-2xl border border-gray-200 dark:border-white/5 grid lg:grid-cols-2">
              
              {/* Imagen Side */}
              <div className="relative h-[400px] lg:h-auto overflow-hidden group">
                <img src={modelsData[activeModel].img} className="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110" alt={modelsData[activeModel].name} />
                <div className="absolute top-8 left-8 bg-black/70 backdrop-blur-md text-white px-5 py-2 rounded-full text-[10px] font-black uppercase tracking-widest">
                  {t.modular.delivery}
                </div>
                
                {/* Acabado Highlight */}
                <div className="absolute bottom-8 left-8 right-8 bg-white/95 dark:bg-[#151515]/95 backdrop-blur-xl p-6 rounded-2xl border border-white/20 shadow-2xl">
                   <div className="flex items-center gap-4 mb-2">
                      <div className="w-8 h-8 rounded-full bg-[#E3DAC9] border-2 border-white shadow-inner" />
                      <div>
                        <p className="text-[10px] text-gray-500 uppercase font-black tracking-widest">{t.modular.finish}</p>
                        <p className="text-sm font-bold text-gray-900 dark:text-white">{t.modular.finishName}</p>
                      </div>
                   </div>
                   <p className="text-[9px] text-gray-500 italic leading-tight">{t.modular.finishNote}</p>
                </div>
              </div>

              {/* Contenido Side */}
              <div className="p-10 lg:p-20 flex flex-col justify-center">
                <span className="text-orange-500 font-black uppercase tracking-[0.2em] text-xs mb-4 inline-block">{modelsData[activeModel].tagline}</span>
                <h2 className="text-4xl lg:text-7xl font-black text-gray-900 dark:text-white uppercase leading-none mb-8">{modelsData[activeModel].name}</h2>
                <p className="text-gray-600 dark:text-neutral-400 text-lg leading-relaxed mb-10">{modelsData[activeModel].desc}</p>
                
                {/* Especificaciones Grid */}
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-12">
                   {modelsData[activeModel].specs.map((spec, i) => (
                     <div key={i} className="flex items-center gap-3 p-4 bg-gray-50 dark:bg-[#111] rounded-xl border border-gray-100 dark:border-white/5 transition-all hover:border-orange-500/30">
                       <div className="w-1.5 h-1.5 rounded-full bg-orange-500 shadow-sm shadow-orange-500" />
                       <span className="text-[11px] font-bold uppercase text-gray-700 dark:text-gray-300">{spec}</span>
                     </div>
                   ))}
                </div>

                {/* Precio y CTAs */}
                <div className="flex flex-col sm:flex-row items-center gap-6 mt-auto pt-10 border-t border-gray-100 dark:border-white/10 w-full">
                   <div className="w-full sm:w-auto">
                     <p className="text-[10px] text-gray-400 uppercase tracking-widest mb-1">{t.modular.basePrice}</p>
                     <p className="text-3xl font-black text-gray-900 dark:text-white">{modelsData[activeModel].price}</p>
                   </div>
                   <div className="flex flex-1 gap-3 w-full sm:w-auto">
                      <button className="flex-1 bg-gray-900 dark:bg-white text-white dark:text-black py-4 rounded-xl font-black uppercase tracking-widest hover:bg-orange-500 hover:text-white transition-all shadow-xl flex items-center justify-center gap-2">
                         <ShoppingBag size={18} /> {t.modular.btnBuy}
                      </button>
                      <button className="px-6 py-4 border-2 border-gray-200 dark:border-white/10 text-gray-900 dark:text-white rounded-xl font-black uppercase tracking-widest hover:bg-gray-100 dark:hover:bg-white/5 transition-all">
                        {t.modular.btnInfo}
                      </button>
                   </div>
                </div>
              </div>
            </div>

            {/* Beneficios Técnicos */}
            <div className="mt-32 grid md:grid-cols-3 gap-8">
               {[
                 { icon: <ShieldCheck size={32}/>, title: t.tech.s1, desc: t.tech.d1 },
                 { icon: <Truck size={32}/>, title: t.tech.s2, desc: t.tech.d2 },
                 { icon: <Clock size={32}/>, title: t.tech.s3, desc: t.tech.d3 }
               ].map((item, i) => (
                 <div key={i} className="p-10 bg-gray-50 dark:bg-[#0a0a0a] rounded-[2.5rem] border border-gray-100 dark:border-white/5 transition-all hover:-translate-y-2 group">
                    <div className="text-orange-500 mb-6 transform transition-transform group-hover:scale-110">{item.icon}</div>
                    <h4 className="text-xl font-black uppercase text-gray-900 dark:text-white mb-4">{item.title}</h4>
                    <p className="text-gray-500 dark:text-neutral-400 leading-relaxed text-sm">{item.desc}</p>
                 </div>
               ))}
            </div>
          </div>
        </main>

        <Footer lang={lang} />
      </div>
    </div>
  );
};

export default App;

